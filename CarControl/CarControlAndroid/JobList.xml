<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <pages>
      <page name ="tab_motor">
        <display name="label_motor_bat_voltage" result="STAT_UBATT_WERT" format="7.2R" />
        <display name="label_motor_temp" result="STAT_CTSCD_tClntLin_WERT" format="6.2R" />
        <display name="label_motor_air_mass" result="STAT_LUFTMASSE_WERT" format="7.2R" />
        <display name="label_motor_intake_air_temp" result="STAT_LADELUFTTEMPERATUR_WERT" format="6.2R" />
        <display name="label_motor_part_filt_dist_since_regen" result="STAT_STRECKE_SEIT_ERFOLGREICHER_REGENERATION_WERT" />
        <display name="label_motor_oil_press_switch" result="STAT_OELDRUCKSCHALTER_EIN_WERT" />
        <display name="label_motor_part_filt_request" result="STAT_REGENERATIONSANFORDERUNG_WERT" />
        <display name="label_motor_part_filt_status" result="STAT_EGT_st_WERT" />
        <display name="label_motor_part_filt_unblocked" result="STAT_REGENERATION_BLOCKIERUNG_UND_FREIGABE_WERT" />
        <strings>
          <string name="tab_motor">Motor</string>
          <string name="label_motor_air_mass">Air mass [kg/h]:</string>
          <string name="label_motor_air_mass_act">Air mass act [mg/pass]:</string>
          <string name="label_motor_air_mass_set">Air mass set [mg/pass]:</string>
          <string name="label_motor_ambient_press">Ambient pressure [mbar]:</string>
          <string name="label_motor_ambient_temp">Ambient temp. [°C]:</string>
          <string name="label_motor_bat_voltage">Battery voltage [V]:</string>
          <string name="label_motor_boost_press_act">Boost pressure act [mbar]:</string>
          <string name="label_motor_boost_press_set">Boost pressure set [mbar]:</string>
          <string name="label_motor_exhaust_press">Exhaust back pressure [mbar]:</string>
          <string name="label_motor_fuel_temp">Fuel temp. [°C]:</string>
          <string name="label_motor_intake_air_temp">Intake air temp. [°C]:</string>
          <string name="label_motor_part_filt_dist_since_regen">Part. filter dist. since regen. [km]:</string>
          <string name="label_motor_part_filt_request">Part. filter regeneration request:</string>
          <string name="label_motor_part_filt_status">Part. filter regeneration:</string>
          <string name="label_motor_part_filt_unblocked">Part. filter unblock regeneration:</string>
          <string name="label_motor_oil_press_switch">Oil pressure switch:</string>
          <string name="label_motor_rail_press_act">Rail pressure act [bar]:</string>
          <string name="label_motor_rail_press_set">Rail pressure set [bar]:</string>
          <string name="label_motor_temp">Motor temperature [°C]:</string>
          <string name="label_motor_temp_before_cat">Temp. before catalyst [°C]:</string>
          <string name="label_motor_temp_before_filter">Temp. before part. filter [°C]:</string>
        </strings>
        <strings lang="de">
          <string name="tab_motor">Motor</string>
          <string name="label_motor_air_mass">Luftmasse [kg/h]:</string>
          <string name="label_motor_air_mass_act">Luftmasse ist [mg/Hub]:</string>
          <string name="label_motor_air_mass_set">Luftmasse soll [mg/Hub]:</string>
          <string name="label_motor_ambient_press">Umgebungsdruck [mbar]:</string>
          <string name="label_motor_ambient_temp">Umgebungstemperatur [°C]:</string>
          <string name="label_motor_bat_voltage">Batteriespannung [V]:</string>
          <string name="label_motor_boost_press_act">Ladedruck ist [mbar]:</string>
          <string name="label_motor_boost_press_set">Ladedruck soll [mbar]:</string>
          <string name="label_motor_exhaust_press">Abgasgegendruck [mbar]:</string>
          <string name="label_motor_fuel_temp">Treibstofftemperatur [°C]:</string>
          <string name="label_motor_intake_air_temp">Ansauglufttemp. [°C]:</string>
          <string name="label_motor_part_filt_dist_since_regen">Partikelfilter Strecke seit Regen. [km]:</string>
          <string name="label_motor_part_filt_request">Partikelfilter Anforderung Regen.:</string>
          <string name="label_motor_part_filt_status">Partikelfilter Regeneration:</string>
          <string name="label_motor_part_filt_unblocked">Partikelfilter Freigabe Regen.:</string>
          <string name="label_motor_oil_press_switch">Öldruckschalter:</string>
          <string name="label_motor_rail_press_act">Raildruck ist [bar]:</string>
          <string name="label_motor_rail_press_set">Raildruck soll [bar]:</string>
          <string name="label_motor_temp">Motortemperatur [°C]:</string>
          <string name="label_motor_temp_before_cat">Temp. vor Katalysator [°C]:</string>
          <string name="label_motor_temp_before_filter">Temp. vor Partikelfilter [°C]:</string>
        </strings>
        <code>
          <![CDATA[
  using System;
  using System.Collections.Generic;
  using EdiabasLib;
  using CarControl;
  using CarControlAndroid;

  class PageClass
  {
    public string GetSgbdFileName()
    {
      return "d_motor";
    }

    public void ExecuteJob(EdiabasNet ediabas, ref Dictionary<string, EdiabasNet.ResultData> resultDict, bool firstCall)
    {
      string argString = "IUBAT;ITKUM;CTSCD_tClntLin;ITKRS;ILMKG;ILMMG;SLMMG;ITUMG;ITKRS;IPLAD;SPLAD;ITLAL;IPUMG;IPRDR;SPRDR;ITAVO;ITAVP1;IPDIP;IDSLRE;IREAN;EGT_st;ISRBF;ISOED";
      if (firstCall)
      {
        argString = "JA;" + argString;
      }
      else
      {
        argString = "NEIN;" + argString;
      }
      ediabas.ArgString = argString;
      ediabas.ArgBinaryStd = null;
      ediabas.ResultsRequests = string.Empty;

      ediabas.ExecuteJob("STATUS_MESSWERTBLOCK_LESEN");

      List<Dictionary<string, EdiabasNet.ResultData>> resultSets = ediabas.ResultSets;
      if (resultSets != null && resultSets.Count >= 2)
      {
          CommThread.MergeResultDictionarys(ref resultDict, resultSets[1]);
      }
    }

    public string FormatResult(Dictionary<string, EdiabasNet.ResultData> resultDict, string resultName)
    {
      string result = string.Empty;
      bool found;

      switch (resultName)
      {
        case "STAT_STRECKE_SEIT_ERFOLGREICHER_REGENERATION_WERT":
          result = string.Format(ActivityMain.culture, "{0,6:0.0}", ActivityMain.GetResultDouble(resultDict, resultName, out found) / 1000.0);
          if (!found) result = string.Empty;
          break;

        case "STAT_OELDRUCKSCHALTER_EIN_WERT":
          result = ((ActivityMain.GetResultDouble (resultDict, resultName, out found) > 0.5) && found) ? "1" : "0";
          if (!found) result = string.Empty;
          break;

        case "STAT_REGENERATIONSANFORDERUNG_WERT":
          result = ((ActivityMain.GetResultDouble (resultDict, resultName, out found) < 0.5) && found) ? "1" : "0";
          if (!found) result = string.Empty;
          break;

        case "STAT_EGT_st_WERT":
          result = ((ActivityMain.GetResultDouble (resultDict, resultName, out found) > 1.5) && found) ? "1" : "0";
          if (!found) result = string.Empty;
          break;

        case "STAT_REGENERATION_BLOCKIERUNG_UND_FREIGABE_WERT":
          result = ((ActivityMain.GetResultDouble (resultDict, resultName, out found) < 0.5) && found) ? "1" : "0";
          if (!found) result = string.Empty;
          break;
      }
      return result;
    }
  }
          ]]>
        </code>
      </page>
  </pages>
</configuration>
